---
title: 'STAT 327: Project'
author: "Dawson Kinsman and Sabastian Zuhorski"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: yeti
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gtools)
library(knitr)
```

# Functions and Classes
Some functions and classes are imported from a separate file.
```{r}
source('tictactoe_functions.R')

randomSimulation = function(numSims, boardSize, df, seed = 0){
  set.seed(seed)
  
  winners<- replicate(numSims, randtictactoe(boardSize))
  table(winners)
  hist(winners, 
       main = paste0('Results of 1,000',boardSize,'x', boardSize,' Tic-Tac-Toe Games'))

  p1 <- sum(winners[winners == 1]) / numSims; p1
  p2 <- length(winners[winners == -1]) / numSims; p2
  draw <- length(winners[winners == 0]) / numSims; draw

  df2 <- data.frame(Winner = c('Player 1', 'Player 2', 'Draw'), 
                 'Board Size' = rep(paste0(boardSize,'x', boardSize), 3), Probability = c(p1,p2, draw))
  df <- rbind(df, df2)
  
  return(df)
}
```
## Constant Values
```{r}
n = 1e3
```

# How does the size of the board effect the probability of Player 1 winning?
                              
```{r}
df <- data.frame(matrix(ncol = 3, nrow = 0))
colnames(df) <- c('Winner', 'Board Size', 'Probability')

df <- randomSimulation(n, 3, df)
df <- randomSimulation(n, 4, df, 1)
df <- randomSimulation(n, 5, df, 2)
df <- randomSimulation(n, 10, df, 3)
#df <- randomSimulation(n, 20, df, 4)

pt <- pivot_wider(df, id_cols = Board.Size, names_from = Winner, values_from = Probability)

knitr::kable(pt, align = 'cccc')
```


# Notes
- We can check if 3 in a row by summing three entries and checking if they are 0 mod 3.
- Right now Player1 is coded as 1, Player2 is coded as -1, and a draw is 0. And I am using winner as an indicator if the game is finished. If not, then winner is NULL.
- For more state on a magic square: https://mathworld.wolfram.com/MagicSquare.html, we have to keep this in mind if we try to visualize any of the boards


